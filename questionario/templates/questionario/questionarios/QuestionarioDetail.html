{% extends 'base/base.html' %}
{% load static %}

{% block title %}Questionário {{questionario.nome}}{% endblock%}


{% block content %}

	<div class="container mt-4 mb-4">
		{% if messages %}
			<ul class="messages">
				{% for message in messages %}
					{% if message.tags == "success" %}
						<div class="alert alert-success alert-dismissible fade show text-black">{{ message|escape }}
							<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
						</div>
					{% else %}
						<div class="alert alert-warning alert-dismissible fade show text-black" >{{ message|escape }}
							<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
						</div>
					{% endif %}
				{% endfor %}
			</ul>
		{% endif %}

		<div class="card card-questionario shadow">
			<h1 class="card-header text-black">Questionário - {{questionario.nome}}</h1>

			<div class="card-body p-3">
				<form action="#" id="formQuestionario">
					<div class="row g-2">

                        <div class="col-md">
                            <div class="form-floating">
                                <input name="nome" type="text" class="form-control border-secondary" id="inputNome" minlength="5" maxlength="50" placeholder=" " value="" required>
                                <label for="inputNome">Nome Completo</label>
                            </div>
						</div>

                    </div>
                    <div class="row g-2">
                        <div class="col-md">

                            <div class="form-floating">
                                <input name="telefone" type="tel" class="form-control border-secondary mb-0" minlenght="10" maxlength="11" id="inputTelefone" placeholder="Exemplo: 63999397825 ou 6332294500" pattern="[0-9]{10-11}">
                                <label for="inputTelefone">Telefone</label>
                                <small class="ml-4 text-muted">DDD e Número. Exemplo:<i> 63999397825 ou 6332294500.</i></small>
                            </div>
                        </div>

                        <div class="col-8" style="min-width: 268px;">
                            <div class="form-floating">
                                <input name="email" type="email" class="form-control border-secondary" id="floatingInput" placeholder="name@example.com">
                                <label for="floatingInput">Email</label>
                            </div>

                        </div>



                    </div>

                    <div class="row g-2">

                        <div class="col-md">
                            <div class="form-floating">
                                <input name="cidade" type="text" class="form-control border-secondary" id="floatingInputGrid" minlength="5" maxlength="50" placeholder=" " value="">
                                <label for="floatingInputGrid">Cidade</label>
                            </div>
                        </div>

                        <div class="col-md">
                            <div class="col-md">
                                <div class="form-floating">
                                    <input name="cargo" type="text" class="form-control border-secondary" id="floatingInputGrid" minlength="3" maxlength="50" placeholder=" " value="">
                                    <label for="floatingInputGrid">Profissão</label>
                                </div>
                            </div>
                        </div>

                        <div class="col-md">
                            <div class="form-floating">
                                <input name="idade" type="number" class="form-control border-secondary" id="idadeInput" placeholder=" ">
                                <label for="idadeInput">Idade</label>
                            </div>
                        </div>

                    </div>

					<hr>
					{% for item in questionario.itemquestionario_set.all %}
						<div class="mx-3">

							<span class="fw-bold text-black" id="questao-{{item.id}}" data-tipo="{{item.tipo}}">{{forloop.counter}})</span>{{item.descricao|safe}}

							{% if item.tipo == 0 %}
								<div class="d-flex my-3 flex-column">
									{% for opcao in item.opcoesitemquestionario_set.all %}
										<div class="form-check mx-3">
											<input class="form-check-input" type="radio" name="item-{{item.id}}" id="opcao{{opcao.id}}" value="{{opcao.valor}}" required>
											<label class="form-check-label" for="opcao{{opcao.id}}">
												{{opcao.valor}}
											</label>
										</div>
									{% endfor %}
								</div>

							{% elif item.tipo == 3 %}
								<div class="d-flex align-items-center">
									<input type="hidden" id="rangeAssoativa-{{item.id}}" name="rangeAssoativa-{{item.id}}" value="{{item.opcoesitemquestionario_set.all|length}}">
									<div class="d-flex flex-column" style="min-width: 35%;">
										{% for opcao in item.opcoesitemquestionario_set.all %}
											<span id="opcao-{{item.id}}-{{forloop.counter}}" data-opcao="{{opcao.id}}">{{forloop.counter}}-{{opcao.valor}}</span>
										{% endfor %}
									</div>
									<div class="d-flex flex-column">
										{% for assoativa in item.itemassociativo_set.all %}
											<div class="d-flex align-items-center my-1">
												<input class="form-control m-0 mx-2 assoativa" id="{{assoativa.id}}" data-item="{{item.id}}" type="text" style="width:3rem; height:2.5rem;" required>
												<span>{{assoativa.valor}}</span>
											</div>
										{% endfor %}
									</div>
								</div>
							{% endif %}
						</div>

						<hr>
					{% endfor %}
					<div class="d-flex justify-content-end">
						<button class="btn btn-primary" type="submit">Enviar</button>
					</div>
				</form>


			</div>
			
			<div class="card-footer d-flex justify-content-center">
				<small><i>Questionário - {{questionario.nome}}</i></small>
			</div>
		</div>



	</div>

    <script src="{% static "JS/QuestionarioControl.js" %}"></script>

{% endblock %}
